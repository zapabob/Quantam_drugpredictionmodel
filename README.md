# Zoltraakを用いた量子機械学習モデルによるDAT阻害剤の予測
# Zoltraakを用いた量子機械学習モデルによるDAT阻害剤の予測

## プロジェクトの説明文書

### 1. はじめに
本プロジェクトでは、Zoltraakを用いた量子機械学習モデルを構築し、ドーパミントランスポーター（DAT）阻害剤の予測を行います。DATは、シナプス間隙でドーパミンの再取り込みを行う膜タンパク質であり、コカインやメタンフェタミンなどの薬物の標的となっています。DATを阻害する化合物は、薬物依存症の治療薬候補として期待されています。

本モデルは、ChEMBLデータベースから取得したDATおよびノルエピネフリントランスポーター（NET）に対するIC50データを用いて学習します。化合物の分子構造から量子化学的特徴量を抽出し、Zoltraakを用いて量子機械学習モデルを構築します。構築したモデルを用いて、新規化合物のDAT阻害活性（IC50）を予測し、コカインとメタンフェタミンに対する選択性（DA/NE比）を評価します。

### 2. 量子機械学習モデルの構築
量子機械学習モデルの構築には、Zoltraakを使用します。Zoltraakは、量子コンピュータ上で動作する機械学習モデルを構築するためのフレームワークです。量子回路のハイパーパラメータを最適化し、古典的な機械学習モデルとしてランダムフォレストを使用します。

モデルの学習には、ChEMBLデータベースから取得したDATおよびNETに対するIC50データを使用します。IC50の閾値を1000μMとし、それ以上の値を持つデータは除外します。外れ値の除去にIQR法を用い、データの標準化を行います。IC50値は、pIC50（-log10(IC50)）に変換します。

化合物の分子構造から、量子化学的特徴量を抽出します。特徴量には、分子量、LogP、水素結合ドナー数、水素結合アクセプター数、TPSA、回転可能結合数などを含めます。さらに、Morgan fingerprintを用いて、分子の部分構造に基づく特徴量を抽出します。

量子回路のハイパーパラメータは、Optunaを用いて最適化します。最適化の目的関数は、k分割交差検証の平均精度とします。ハイパーパラメータには、量子ビットの数、深さ、エンタングルメントの種類、オプティマイザの最大反復回数などを含めます。

### 3. モデルの評価
構築したモデルの性能は、テストデータを用いて評価します。評価指標には、精度、ROC AUC、適合率、再現率、混同行列、R2スコアを用います。コカインとメタンフェタミンを常にテストデータに含め、これらの化合物に対するモデルの予測性能を評価します。

また、コカインとメタンフェタミンのpIC50を予測し、その差からDA/NE比を計算します。DA/NE比は、コカインとメタンフェタミンに対する選択性の指標となります。

### 4. ユーザーインターフェース
PyQt5を用いて、グラフィカルユーザーインターフェース（GUI）を構築します。GUIには、SMILES入力欄、モデル学習ボタン、pIC50予測ボタン、DA/NE比計算ボタンを含めます。ユーザーは、GUIを通じて新規化合物のSMILESを入力し、そのpIC50とDA/NE比を予測することができます。モデル学習の進捗状況や結果もGUI上に表示されます。

### 5. 結論
本プロジェクトでは、Zoltraakを用いた量子機械学習モデルを構築し、DAT阻害剤の予測を行います。このモデルにより、新規化合物のDAT阻害活性とコカインとメタンフェタミンに対する選択性を効率的に予測することができます。本モデルは、創薬の初期段階におけるスクリーニングや最適化に役立つことが期待されます。

## ユーザーマニュアル

### 1. インストール
1. 本プロジェクトのソースコードをダウンロードまたはクローンします。
2. 必要なライブラリをインストールします。
   ```
   pip install -r requirements.txt
   ```

### 2. 使用方法
1. コマンドラインから、以下のコマンドを実行してアプリケーションを起動します。
   ```
   python main.py
   ```
2. GUIが表示されます。
3. 「Train Model」ボタンをクリックして、量子機械学習モデルを学習します。学習には数分から数十分かかる場合があります。
4. 学習が完了すると、モデルの評価結果が表示されます。
5. 新規化合物のSMILESを「SMILES」入力欄に入力します。
6. 「Predict pIC50」ボタンをクリックして、入力した化合物のpIC50を予測します。
7. 「Calculate DA/NE Ratio」ボタンをクリックして、コカインとメタンフェタミンに対する選択性（DA/NE比）を計算します。

### 3. 注意事項
- 学習に使用するデータセットは、ChEMBLデータベースから取得しています。インターネット接続が必要です。
- 学習には数分から数十分かかる場合があります。学習中はGUIが応答しない場合がありますが、処理が終了するまでお待ちください。
- 予測の精度は、学習に使用したデータセットに依存します。実際の活性とは異なる場合があります。

### 4. トラブルシューティング
- アプリケーションが起動しない場合は、必要なライブラリが正しくインストールされているか確認してください。
- 学習に失敗する場合は、インターネット接続を確認してください。ChEMBLデータベースにアクセスできない場合、データセットを取得できません。
- その他のエラーが発生した場合は、エラーメッセージを確認し、適切な対処を行ってください。

### 5. 連絡先
本プロジェクトに関するご質問は、以下の連絡先までお願いいたします。
- 氏名：Zoltraak開発チーム
- メール：zoltraak@example.com

以上が、プロジェクトの説明文書とユーザーマニュアルの例です。プロジェクトの背景、量子機械学習モデルの構築方法、モデルの評価方法、ユーザーインターフェースの説明に加えて、インストール方法、使用方法、注意事項、トラブルシューティング、連絡先を記載しています。これにより、ユーザーがアプリケーションを円滑に使用できるようサポートします。
